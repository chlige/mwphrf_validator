# MWPHRF Validator

Java application to retrieve/validate MWPHRF (https://mwphrf.org) ratings for a set of boats. This application was primarily designed to retrieve the MWPHRF ratings for boats registered for a race on YachtScoring.com.

## Importing Entries

Entries are imported into the MWPHRF Validator using the menu **File** > **Load entries...**. Currently the import format is expected to be older Microsoft Excel (.xls).  This is the same format as generated by YachtScoring.

### Downloading Entries from YachtScoring

Follow these steps to generate the competitors Excel file that can be loaded by MWPHRF Validator.

1. Login to the event admin site for YachtScoring (https://www.yachtscoring.com/admin_login.cfm)
2. Select the desired event from the list of events.
3. In the _Event Reports_ section (middle), select *All Entry Information*.
4. Once the _Full Competitors' Information_ is displayed, click the *CSV* button to export the data to an Excel file.

### Import format

Currently the import format is expected to be older Microsoft Excel (.xls) with the following columns.

_NOTE_: The columns do not have to be in the order that is listed and any additional columns will be ignored.


Column         | Description
-------------- | --------------------------------------------------
YACHT_SAIL_2   | Sail number 
YACHT_NAME     | Boat name
OWNER_FIRST    | First name of the boat's owner
OWNER_LAST     | Last name of the boat's owner
YACHT_MAKE     | Make and model of the boat
RACING_CIRCLE  | Racing circle for the entry
DIVISION       | Racing division, within the circle, for the entry
CLASS_ALT_NAME | Racing class, within the division, for the entry

## Viewing and filtering entries

Once the entries are loaded into the main table they can be sorted by any of the columns by clicking on the column headers or filtered by racing circle, division and/or class using the pull-down boxes near the top of the window.  Please note, these categories are nested, i.e. classes are part of a division which are part of a circle.

## Finding/downloading MWPHRF details

MWPHRF details, i.e. certificates, can be downloaded from the MWPHRF website using the **Find Ratings** button.  The application will find possible entries searching first by sail number and yacht name.  If no entries are found, then it will search the MWPHRF website by the make and model of the entry.  If an entry is found that has the same sail number and name it will be automatically selected and displayed in the _PHRF Match_ column.  If there is not an entry that match those criteria, then it will list the number of records fetched for that entry. 

### Selecting a MWPHRF record

To manually select a desired MWPHRF record for the entry click on the row in the _PHRF Match_ column to display a dropdown box and select the desired MWPHRF record to use for that entry.

**NOTE:** automatically selected matches can also be changed by clicking on the match and using the same dropdown box feature to change the desired MWPHRF record to use.

### Selecting a MWPHRF certificate year

When a MWPHRF record is selected, either manually or automatically, the _Certificate Year_ column will display the most recent certificate year for that MWPHRF record.  The certificate year can be changed by clicking on the year and selecting the year from the dropdown box that appears

### Selecting a MWPHRF value

MWPHRF certificates typically contain four (4) different values; BHCP, HCP, DHCP and NSHCP.  The value displayed in the table can be selected by pressing the **HCP**, **DHCP** or **NSHCP** buttons above the table.   When pressing this button it will set the displayed value for all entries currently _visible_ in the table. It is possible, once the MWPHRF records have been loaded and selected for each entry, to use the _circle_ , _division_ and _class_ filters to restrict the entries when using the **HCP**, **DHCP** or **NSHCP** buttons.  

For example, one could press **HCP** to use the standard handicap for all entries, then use the _class_ filter to select the non-spinnaker class and click **NSHCP** to use the non-spinnaker value for entries in the non-spinnaker class while retaining the HCP rating for all other entries. The value used for individual entries can be also be changed by clicking on the value for that entry and selecting the desired value from the dropdown box.

## Exporting Entries

Entries in the table can be exported to a file using one of the two menu options.

* **File** > **Export visible entries...** - This will export only the entries currently displayed in the table.
* **File** > **Export all entries...** - This will export all loaded entries regardless if they are currently displayed in the table

### Export formats

Records can be saved in the following formats

* Tab delimited file: .tsv or .txt
* Comma separated values file: .csv
* (older) Microsoft Excel format: .xls

The exported table will contain the following columns.

Column           | Description
---------------- | ----------------------------------------------------------------------------------
Sail number      | Sail number of the boat
Yacht Name       | Boat name
Make Model       | Make and model of the boat
Owner            | First and last name of the owner
Circle           | Racing circle for the entry
Division         | Racing division, within the circle, for the entry
Class            | Racing class, within the division, for the entry
PHRF Match       | Sail number and yacht name of the matched MWPHRF certificate
Certificate Year | Issued year of the matched MWPHRF certificate
Rating value     | Numerical value of the chosen rating variable from the MWPHRF certificate
Rating type      | The rating variable, i.e. HCP, DHCP or NSHCP, selected from the MWPHRF certificate